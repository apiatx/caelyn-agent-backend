Change 2: Add StockTwits to the __init__ method. Find:
python        self.finviz = FinvizScraper()
Right after it, add:
python        self.stocktwits = StockTwitsProvider()
Change 3: Update research_ticker to include sentiment. Replace the existing research_ticker method with:
python    async def research_ticker(self, ticker: str) -> dict:
        """
        Get everything about a single stock.
        Used when someone asks "analyze NVDA" or "what's happening with AAPL".
        """
        ticker = ticker.upper()
        return {
            "snapshot": self.polygon.get_snapshot(ticker),
            "technicals": self.polygon.get_technicals(ticker),
            "details": self.polygon.get_ticker_details(ticker),
            "news": self.polygon.get_news(ticker, limit=10),
            "sentiment": await self.stocktwits.get_sentiment(ticker),
        }
Change 4: Update scan_market to include trending tickers and sentiment. Replace the existing scan_market method with:
python    async def scan_market(self) -> dict:
        """Broad market overview with catalyst and sentiment data."""
        movers = self.polygon.get_market_movers()

        top_gainer_tickers = [
            g["ticker"] for g in movers.get("gainers", [])[:5]
        ]

        catalyst_data = {}
        for ticker in top_gainer_tickers:
            catalyst_data[ticker] = {
                "details": self.polygon.get_ticker_details(ticker),
                "technicals": self.polygon.get_technicals(ticker),
                "news": self.polygon.get_ticker_events(ticker)["news"],
                "sentiment": await self.stocktwits.get_sentiment(ticker),
            }

        trending = await self.stocktwits.get_trending()

        return {
            "movers": movers,
            "market_news": self.polygon.get_news(limit=15),
            "screener_gainers": await self.finviz.get_screener_results(
                "ta_topgainers"
            ),
            "catalyst_data": catalyst_data,
            "stocktwits_trending": trending,
        }
```

## Step 3: Update the System Prompt

Open `agent/prompts.py`. Find this line in the system prompt:
```
- Catalysts (use the news data provided to identify WHY a stock is moving - never say "need to verify")
```

Right after it, add:
```
- Social Sentiment (use StockTwits data to gauge retail trader sentiment - bullish/bearish ratio, watchlist count, and trending status)
- When StockTwits data shows high bullish sentiment on a stock that's also showing strong technicals, flag this as a confluence signal
- When a stock is trending on StockTwits with bearish sentiment, warn about potential retail trap or short squeeze setup
- Use the actual recent StockTwits messages to identify what retail traders are focused on
Step 4: Re-publish
After making all these changes, re-publish your backend so the live version gets the updates.
Then test with prompts like:

"What are the top movers today?" (now includes sentiment for each)
"Analyze NVDA" (now includes StockTwits sentiment and recent chatter)
"What's trending on social media?" (uses StockTwits trending data)

The agent will now be able to say things like "CRSR is 78% bullish on StockTwits with 15,000 watchlist adds â€” retail sentiment strongly supports the move" instead of hedging.